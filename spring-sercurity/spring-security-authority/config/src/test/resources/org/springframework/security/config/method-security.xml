<?xml version="1.0" encoding="UTF-8"?>

<b:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:b="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/tx https://www.springframework.org/schema/tx/spring-tx.xsd
		http://www.springframework.org/schema/security https://www.springframework.org/schema/security/spring-security.xsd">

	<tx:annotation-driven />

	<b:bean name="transactionManager" class="org.springframework.security.config.MockTransactionManager" />

	<b:bean class='org.springframework.beans.factory.config.PropertyPlaceholderConfigurer'/>

	<b:bean id="transactionalTarget" class="org.springframework.security.config.TransactionalTestBusinessBean">
		<intercept-methods>
			<protect method="*" access="ROLE_USER" />
		</intercept-methods>
	</b:bean>


	<b:bean id="target" class="org.springframework.security.config.TestBusinessBeanImpl">
		<!-- This will add a security interceptor to the bean -->
		<intercept-methods>
			<protect method="org.springframework.security.config.TestBusinessBean.set*" access="${admin.role}" />
			<protect method="get*" access="${admin.role},ROLE_USER" />
			<protect method="doSomething" access="ROLE_USER" />
		</intercept-methods>
	</b:bean>

	<authentication-manager>
		<authentication-provider>
			<user-service>
				<user name="bob" password="bobspassword" authorities="ROLE_A,ROLE_B" />
				<user name="bill" password="billspassword" authorities="ROLE_A,ROLE_B,AUTH_OTHER" />
			</user-service>
		</authentication-provider>
	</authentication-manager>

</b:beans>
